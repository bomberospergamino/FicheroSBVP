<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fichador â€“ Bomberos Pergamino</title>

  <style>
    body{
      margin:0;
      min-height:100vh;
      font-family: system-ui, Arial, sans-serif;
      background: linear-gradient(135deg,#062f45,#0a3a53);
      color:white;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .card{
      width:100%;
      max-width:420px;
      background: rgba(255,255,255,.08);
      border-radius:18px;
      padding:22px;
      box-shadow:0 20px 40px rgba(0,0,0,.4);
    }

    .top{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:16px;
    }

    .top img{
      width:56px;
      height:56px;
    }

    .clock{
      text-align:right;
      font-weight:700;
      font-size:14px;
    }

    .clock .time{
      font-size:18px;
      font-weight:900;
    }

    h2{
      text-align:center;
      margin:10px 0;
      letter-spacing:1px;
    }

    input{
      width:100%;
      padding:16px;
      font-size:30px;
      font-weight:900;
      text-align:center;
      border-radius:14px;
      border:none;
      outline:none;
      margin:14px 0;
    }

    .buttons{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }

    button{
      padding:14px;
      font-size:16px;
      font-weight:900;
      border:none;
      border-radius:14px;
      cursor:pointer;
      color:white;
    }

    .salida{ background:#c7373b; }
    .entrada{ background:#2e9b4f; }

    .footer{
      display:flex;
      justify-content:space-between;
      margin-top:14px;
      align-items:center;
    }

    .consultar{
      background:rgba(255,255,255,.15);
      padding:10px 12px;
      font-size:12px;
      border-radius:12px;
      font-weight:800;
    }

    .msg{
      margin-top:12px;
      font-size:13px;
      min-height:18px;
    }
  </style>
</head>

<body>
  <div class="card">

    <div class="top">
      <img src="logo.png" alt="Bomberos">
      <div class="clock">
        <div id="date"></div>
        <div class="time" id="time"></div>
      </div>
    </div>

    <h2>FICHADOR</h2>

    <input id="legajo" placeholder="LEGAJO" inputmode="numeric">

    <div class="buttons">
      <button class="salida" onclick="fichar('SALIDA')">âŸµ SALIDA</button>
      <button class="entrada" onclick="fichar('INGRESO')">ENTRADA âŸ¶</button>
    </div>

    <div class="footer">
      <button class="consultar" onclick="consultar()">CONSULTAR ESTADO</button>
      <div class="msg" id="msg"></div>
    </div>

  </div>

<script>
  // ðŸ”— TU ENDPOINT (NO SE CAMBIA)
  const ENDPOINT = "https://script.google.com/macros/s/AKfycbzMSS1WIv2G53yu9jaWlianwsq2A6LEjlTY-pdnlD2b_awVtxNC7Il7AcnOxwTtNY_d/exec";

  const tz = "America/Argentina/Buenos_Aires";

  function clock(){
    const d = new Date();
    document.getElementById("date").textContent =
      d.toLocaleDateString("es-AR",{ timeZone:tz });
    document.getElementById("time").textContent =
      d.toLocaleTimeString("es-AR",{ timeZone:tz });
  }
  setInterval(clock,1000);
  clock();

  async function fichar(mov){
    const legajo = document.getElementById("legajo").value.trim();
    if(!/^\d+$/.test(legajo)){
      show("Legajo invÃ¡lido");
      return;
    }

    const payload = { legajo, movimiento:mov };

    const r = await fetch(ENDPOINT,{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify(payload)
    });

    const j = await r.json();
    show(j.ok ? "Fichada registrada" : j.error || "Error");

    document.getElementById("legajo").value="";
    document.getElementById("legajo").focus();
  }

  async function consultar(){
    const legajo = document.getElementById("legajo").value.trim();
    if(!/^\d+$/.test(legajo)){
      show("IngresÃ¡ un legajo");
      return;
    }

    const r = await fetch(`${ENDPOINT}?action=estado&legajo=${legajo}`);
    const j = await r.json();

    show(j.estado ? `Estado: ${j.estado}` : "Sin registro");
  }

  function show(t){
    document.getElementById("msg").textContent = t;
  }
</script>
</body>
</html>
