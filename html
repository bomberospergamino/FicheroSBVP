<!doctype html>
<html lang="es">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Prueba fichada</title></head>
<body style="font-family:system-ui;max-width:420px;margin:30px auto;padding:0 14px">
  <h3>Prueba fichada</h3>
  <input id="legajo" placeholder="LEGAJO" inputmode="numeric" style="font-size:18px;padding:10px;width:100%">
  <button onclick="fichar('INGRESO')" style="font-size:18px;padding:10px;width:100%;margin-top:10px">Ingreso</button>
  <button onclick="fichar('SALIDA')" style="font-size:18px;padding:10px;width:100%;margin-top:10px">Salida</button>
  <pre id="out" style="margin-top:12px;background:#f5f5f5;padding:10px;white-space:pre-wrap"></pre>
<script>
const ENDPOINT="https://script.google.com/macros/s/AKfycbzMSS1WIv2G53yu9jaWlianwsq2A6LEjlTY-pdnlD2b_awVtxNC7Il7AcnOxwTtNY_d/exec";
async function getIP(){ try{ return (await (await fetch("https://api.ipify.org?format=json")).json()).ip||"" }catch(e){return ""} }
async function fichar(mov){
  const legajo=document.getElementById("legajo").value.trim();
  const ip=await getIP();
  const payload={legajo:legajo,movimiento:mov,ip_externa:ip,user_agent:navigator.userAgent};
  const r=await fetch(ENDPOINT,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(payload)});
  const t=await r.text();
  document.getElementById("out").textContent=t;
}
</script>
</body>
</html>
